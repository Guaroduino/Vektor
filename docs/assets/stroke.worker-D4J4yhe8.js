(function(){"use strict";let o=null,e=null,r=1,a=null,x=16,g=1;function T(i,t,s,n){o=i,r=n,o.width=t,o.height=s,e=o.getContext("2d"),e&&(e.setTransform(r,0,0,r,0,0),e.fillStyle="#eeeeee",e.imageSmoothingEnabled=!0)}function v(i,t,s){!o||!e||(r=s||r,o.width=i,o.height=t,e=o.getContext("2d"),e&&e.setTransform(r,0,0,r,0,0))}function z(i,t,s=16){if(!e)return;const n=i.x,l=i.y,w=i.p??.5,h=t.x,u=t.y,A=t.p??.5;let m=h-n,b=u-l,d=Math.hypot(m,b);if(d<.001)return;const p=-b/d,c=m/d,f=s*w*.5,y=s*A*.5,S=n+p*f,M=l+c*f,P=n-p*f,C=l-c*f,W=h-p*y,j=u-c*y,E=h+p*y,k=u+c*y;e.beginPath(),e.moveTo(S,M),e.lineTo(P,C),e.lineTo(W,j),e.lineTo(E,k),e.closePath(),e.save(),e.globalAlpha=g,e.fillStyle="#eeeeee",e.fill(),e.restore()}self.onmessage=i=>{const t=i.data;if(!(!t||typeof t!="object")){if(t.type==="init"&&t.canvas){try{T(t.canvas,t.width||0,t.height||0,t.dpr||1),self.postMessage({type:"log",msg:"initialized"})}catch{self.postMessage({type:"log",msg:"init failed"})}return}if(t.type==="resize"){v(t.width||0,t.height||0,t.dpr||r);return}if(t.type==="reset"){a=null;return}if(t.type==="params"){typeof t.size=="number"&&(x=t.size),typeof t.alpha=="number"&&(g=t.alpha);return}if(t.type==="points"&&Array.isArray(t.points)){const s=t.points;for(const n of s){if(!a){a={x:n.x,y:n.y,p:n.p};continue}const l={x:n.x,y:n.y,p:n.p};z(a,l,x),a=l}return}}}})();
