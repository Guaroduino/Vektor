(function(){"use strict";let s=null,e=null,r=1,a=null,x=16,b=1,h="#eeeeee";function S(i,t,o,n){s=i,r=n,s.width=t,s.height=o,e=s.getContext("2d"),e&&(e.setTransform(r,0,0,r,0,0),e.fillStyle="#eeeeee",e.imageSmoothingEnabled=!0)}function A(i,t,o){!s||!e||(r=o||r,s.width=i,s.height=t,e=s.getContext("2d"),e&&e.setTransform(r,0,0,r,0,0))}function C(i,t,o=16){if(!e)return;const n=i.x,l=i.y,M=i.p??.5,u=t.x,d=t.y,W=t.p??.5;let m=u-n,T=d-l,g=Math.hypot(m,T);if(g<.001)return;const p=-T/g,f=m/g,c=o*M*.5,y=o*W*.5,v=n+p*c,z=l+f*c,j=n-p*c,E=l-f*c,w=u-p*y,P=d-f*y,k=u+p*y,q=d+f*y;e.save(),e.globalAlpha=b,e.fillStyle=h,e.beginPath(),e.moveTo(v,z),e.lineTo(j,E),e.lineTo(w,P),e.closePath(),e.fill(),e.beginPath(),e.moveTo(v,z),e.lineTo(w,P),e.lineTo(k,q),e.closePath(),e.fill(),e.restore()}self.onmessage=i=>{const t=i.data;if(!(!t||typeof t!="object")){if(t.type==="init"&&t.canvas){try{S(t.canvas,t.width||0,t.height||0,t.dpr||1),self.postMessage({type:"log",msg:"initialized"})}catch{self.postMessage({type:"log",msg:"init failed"})}return}if(t.type==="resize"){A(t.width||0,t.height||0,t.dpr||r);return}if(t.type==="reset"){a=null;return}if(t.type==="params"){typeof t.size=="number"&&(x=t.size),typeof t.alpha=="number"&&(b=t.alpha),typeof t.color=="string"&&(h=t.color,e&&(e.fillStyle=h));return}if(t.type==="points"&&Array.isArray(t.points)){const o=t.points;for(const n of o){if(!a){a={x:n.x,y:n.y,p:n.p};continue}const l={x:n.x,y:n.y,p:n.p};C(a,l,x),a=l}return}}}})();
