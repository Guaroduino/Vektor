import{T as p,B as i,D as h,n as u,G as x}from"./index-DQEu1H_Z.js";const v={};function G(n,t,s){let e=2166136261;for(let a=0;a<t;a++)e^=n[a].uid,e=Math.imul(e,16777619),e>>>=0;return v[e]||C(n,t,e,s)}function C(n,t,s,e){const a={};let o=0;for(let c=0;c<e;c++){const l=c<t?n[c]:p.EMPTY.source;a[o++]=l.source,a[o++]=l.style}const r=new i(a);return v[s]=r,r}class d{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,s){const e=h.get().createCanvas();e.width=t,e.height=s;const a=e.getContext("2d");return{canvas:e,context:a}}getOptimalCanvasAndContext(t,s,e=1){t=Math.ceil(t*e-1e-6),s=Math.ceil(s*e-1e-6),t=u(t),s=u(s);const a=(t<<17)+(s<<1);this._canvasPool[a]||(this._canvasPool[a]=[]);let o=this._canvasPool[a].pop();return o||(o=this._createCanvasAndContext(t,s)),o}returnCanvasAndContext(t){const s=t.canvas,{width:e,height:a}=s,o=(e<<17)+(a<<1);t.context.resetTransform(),t.context.clearRect(0,0,e,a),this._canvasPool[o].push(t)}clear(){this._canvasPool={}}}const P=new d;x.register(P);export{P as C,G as g};
